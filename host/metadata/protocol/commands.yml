description: "Commands and payload layouts; cmd_id is now in header, not payload"

commands:
  NONE:
    payload: []          # no arguments
    cmd_id: constants:cmd_none
    description: "No-op / ignored command ID (used for streams)"

  START_STREAM:
    payload:
      - name: sensor_runtime_id
        type: uint8
        description: "Runtime sensor ID to start streaming"
    cmd_id: 0x01
    description: "Start streaming"
    requires_streaming: true

  STOP_STREAM:
    payload:
      - name: sensor_runtime_id
        type: uint8
        description: "Runtime sensor ID to start streaming"
    cmd_id: 0x02
    description: "Stop streaming"
    requires_streaming: true

  SET_PERIOD:
    payload:
      - name: sensor_runtime_id
        type: uint8
        description: "Runtime sensor ID"
      - name: period_ms
        type: uint16
        description: "Sampling period in milliseconds"
    cmd_id: 0x03
    description: "Set stream period"
    requires_streaming: true

  GET_PERIOD:
    payload:
      - name: sensor_runtime_id
        type: uint8
        description: "Runtime sensor ID"
    response_payload:
      - name: period_ms
        type: uint32
        description: "Current stream period in milliseconds"
    cmd_id: 0x04
    description: "Get stream period"
    requires_streaming: true

  PING:
    payload: []
    response_payload: []
    cmd_id: 0x05
    description: "Ping MCU to check connectivity"

  GET_SENSORS:
    payload: []
    response_payload: 
      - name: sensors
        type: array
        description: "List of detected sensors"
        items:
          type: struct
          fields:
            - name: sensor_runtime_id
              type: uint8
              description: "Runtime sensor ID"
            - name: type_id
              type: uint8
              description: "Static sensor type ID"
    cmd_id: 0x06
    description: "Enumerate all sensors connected to the MCU"

  READ_SENSOR:
    cmd_id: 0x07
    target: sensor
    payload:
      - name: sensor_runtime_id
        type: uint8
    response_payload:
      payload_type: sensor_packet
    description: "Read value of a sensor (Blocking, non-streaming)"

  GET_UPTIME:
    payload: []
    response_payload:
      - name: uptime_ms
        type: uint32
        description: "Milliseconds since MCU boot"
    cmd_id: 0x08
    description: "Get MCU uptime in ms (up to ~49 days)"
